name: Build EXE
on: push
jobs:
  build:
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v4
    - uses: actions/setup-python@v4
      with:
        python-version: '3.8'  # 关键：Python 3.8
    - run: pip install pyinstaller xlrd openpyxl
    - run: pyinstaller --onefile --noupx --name "蔬心兰汇总工具" main.py
    - run: |
        # 创建批处理文件
        echo '@echo off' > 运行程序.bat
        echo 'chcp 65001 > nul' >> 运行程序.bat
        echo 'echo 正在启动蔬心兰汇总工具...' >> 运行程序.bat
        echo 'echo.' >> 运行程序.bat
        echo '蔬心兰汇总工具.exe' >> 运行程序.bat
        echo 'pause' >> 运行程序.bat
    - uses: actions/upload-artifact@v4
      with:
        name: 蔬心兰汇总工具
        path: |
          dist/蔬心兰汇总工具.exe
          运行程序.bat
          README.txt